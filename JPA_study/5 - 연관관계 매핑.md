# ì—°ê´€ê´€ê³„ ë§¤í•‘

### ì˜ ëª»ëœ ê²½ìš°

ì˜ˆì œ - íšŒì› : íŒ€ = N : 1

ì˜ëª»ëœ ê²½ìš° : ê°ì²´ ì§€í–¥ì  ë°©ë²•ì´ ì•„ë‹˜,

```java
@Id 
@GeneratedValue
@Column(name = "MEMBER_ID")
private Long id;

@Column(name = "USERNAME")
private String name;

@Column(name = "TEAM_ID")
private Long TeamId;
```

```java
//íŒ€ì €ì¥
Team team = new Team();
team.setName("TeamA")
em.persist(team);

//íšŒì› ì €ì¥
Member member = new Member();
member.setName("member1");
member.setTeam(team);
em.persist(member);

//memberê°ì²´ì˜ ì•„ì´ë””ë¡œ ì°¾ìŒ
Member findMember = em.find(Member.class, member.getId());
//ì°¾ì€ íšŒì›ì˜ ì†Œì† íŒ€ ì•„ì´ë””ë¥¼ ì°¾ìŒ
Long member_teamId = findMember.getTeamId();
//íŒ€ì•„ì´ë””ë¡œ íŒ€ ê°ì²´ë¥¼ ì°¾ìŒ
Team findTeam = em.find(Team.class, findTeamId);
```

## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„

![í…Œì´ë¸”êµ¬ì¡°](img/4.png)

```java
@Id @GeneratedValue
@Column(name = "MEMBER_ID")
private Long id;

@Column(name = "USERNAME")
private String name;

@ManyToOne
@JoinColumn(name = "TEAM_ID")
private Team team;
```

- @ManytoOne - Many : Member, One : Team
- @JoinColumn(name = "TEAM_ID") - ì¡°ì¸í•˜ê³  ìˆëŠ” ì»¬ëŸ¼ì˜ dbì»¬ëŸ¼ëª…

```java
//íŒ€ì €ì¥
Team team = new Team();
team.setName("TeamA")
em.persist(team);

//íšŒì› ì €ì¥
Member member = new Member();
member.setName("member1");
member.setTeam(team);
em.persist(member);

//memberê°ì²´ì˜ ì•„ì´ë””ë¡œ ì°¾ìŒ
Member findMember = em.find(Member.class, member.getId());
//ë°”ë¡œ Teamê°ì²´ë¥¼ ë¶ˆëŸ¬ì™€ Teamê°ì²´ì— ì €ì¥ëœ íŒ…ì˜ ì´ë¦„ì„ ì°¾ìŒ
System.out.println("findMember Team : " + findMember.getTeam().getName());
```

```java
//íŒ€ ì•„ì´ë””ê°€ 100ë²ˆì¸ íŒ€ì´ ìˆë‹¤ê³  ê°€ì •
Team newTeam = em.find(Team.class, 100L);
//merber ê°ì²´ì˜ íŒ€ì„ ìƒˆë¡œìš´ íŒ€ìœ¼ë¡œ ë³€ê²½
findMember.setTeam(newTeam);
```

## ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì™€ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸

```java
Team team = new Team();
team.setName("TeamA");
em.persist(team);

Member member1 = new Member();
member1.setName("member1");
member1.setTeam(team);
em.persist(member1);

Member member2 = new Member();
member2.setName("member2");
member2.setTeam(team);
em.persist(member2);

**em.flush(); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ì¿¼ë¦¬ë¥¼ dbë¡œ ë‚ ë¦¼
em.clear(); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¹„ì›€**

Member findMember = em.find(Member.class, member1.getId()); // dbì—ì„œ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
System.out.println("Team = " + findMember.getTeam().getName());

List<Member> members = findMember.getTeam().getMembers(); //ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„

for (Member m : members) {
    System.out.println("m = : " + m.getName());
}
```

em.fluch(); ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ì¿¼ë¦¬ë¥¼ dbë¡œ ë‚ ë¦° í›„ em.clear(); í•˜ì—¬ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¹„ìš°ë©´ em.find()ë¡œ ì¡°íšŒí–ˆì„ ë•Œ 1ì°¨ìºì‹œê°€ ì•„ë‹Œ dbì—ì„œ ê°’ì„ ì°¾ì•„ì˜¤ê¸° ë•Œë¬¸ì— findMemberì— í•´ë‹¹í•˜ëŠ” íŒ€ì˜ íšŒì›ë¦¬ìŠ¤íŠ¸ë¥¼ ë°›ì•„ ì˜¬ ìˆ˜ ìˆë‹¤.

ë§Œì•½í•˜ì§€ ì•Šìœ¼ë©´ 1ì°¨ìºì‹œì—ì„œ ê°’ì„ ë°›ì•„ì˜¤ê¸° ë•Œë¬¸ì— 

- OnetoMany
    - 1 : Nì˜ ê´€ê³„ì´ê¸° ë•Œë¬¸ì—Collectionìœ¼ë¡œë§Œ ë°›ì„ ìˆ˜ ìˆë‹¤
    

### ê°ì²´ì™€ í…Œì´ë¸”ì´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´

- í…Œì´ë¸” : ì™¸ë˜í‚¤ í•˜ë‚˜ë¡œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ê°€ì§„ë‹¤
- ê°ì²´ : ì–‘ë°©í–¥ì„ ì°¸ì¡°í•˜ê¸° ìœ„í•´ì„œ ë‹¨ë°©í–¥ê´€ê³„ 2ê°œë¡œ ì–‘ë±¡í–¥ ì—°ê´€ê´€ê³„ë¥¼ ê°€ì§„ë‹¤.

### ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸

- ê°ì²´ì˜ ë‘ê´€ê³„ì¤‘ í•˜ë‚˜ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì§€ì •í•œë‹¤.
- ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ì™¸ë˜í‚¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
- ì£¼ì¸ì´ ì•„ë‹Œìª½ì€ ì½ê¸°ë§Œ ê°€ëŠ¥í•˜ë‹¤.
- **ì£¼ì¸ì´ ì•„ë‹ ê²½ìš° mappedBy ì†ì„±ìœ¼ë¡œ ì£¼ì¸ì„ ì§€ì •í•œë‹¤.**
- jpaê°€ dbì— ê°’ì„ ë„£ì„ ë•ŒëŠ” ì£¼ì¸ì˜ ê°’ë§Œ ì°¸ì¡°í•˜ì—¬ dbì— ì €ì¥í•œë‹¤.

### ëˆ„êµ¬ë¥¼ ì£¼ì¸ìœ¼ë¡œ? â†’ ì™¸ë˜í‚¤ê°€ ìˆëŠ”ê³³ì´ ì£¼ì¸

ì™¸ë˜í‚¤ê°€ ìˆëŠ”ê³³ì´ N, ì—†ëŠ”ê³³ì€ 1 (ë§ì€ ìª½ì´ ì£¼ì¸ì´ëœë‹¤.)

```java
Team team = new Team();
team.setName("TeamA");
em.persist(team);

Member member = new Member();
member.setName("member1");
em.persist(member);

//jpaì—ì„œ ì°¸ì¡°í•˜ì§„ ì•Šì§€ë§Œ ìˆœìˆ˜í•œ ê°ì²´ ê´€ê³„ë¥¼ ê³ ë ¤í•˜ë©´ í•­ìƒ ì–‘ìª½ë‹¤ ê°’ì„ ì…ë ¥í•´ì•¼í•œë‹¤.
team.getMembers().add(member); 

//ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì— ê°’ ì„¤ì •
member.setTeam(team); //jpa ì°¸ì¡°

```

- í¸ì˜ ë©”ì†Œë“œë¥¼ ì´ìš©ê°€ëŠ¥
    
    ì£¼ì˜! í•œêµ°ë°ì„œë§Œ í•´ì•¼í•œë‹¤.
    

ğŸ“**ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì£¼ì˜ - ì‹¤ìŠµ**

- ìˆœìˆ˜ ê°ì²´ ìƒíƒœë¥¼ ê³ ë ¤í•´ì„œ í•­ìƒ ì–‘ìª½ì— ê°’ì„ ì„¤ì •í•˜ì
- ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œë¥¼ ìƒì„±í•˜ì
- ì–‘ë°©í–¥ ë§¤í•‘ì‹œì— ë¬´í•œ ë£¨í”„ë¥¼ ì¡°ì‹¬í•˜ì
    
    ì˜ˆ: toString(), lombok, JSON ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬
    

ê²°ë¡  - ë‹¨ë°©í–¥ì„ ê¶Œì¥í•˜ì§€ë§Œ JPQLì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
